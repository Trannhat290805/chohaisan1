<div class="checkout-container">
    <h2 class="checkout-title">Thanh To√°n</h2>

    <form method="post" action="{% url 'dat_hang' %}">
        {% csrf_token %}

        <!-- ƒê·ªãa ch·ªâ giao h√†ng -->
        <div class="checkout-box">
            <div class="toggle-header" onclick="toggleAddress()">
                <h4>üìç ƒê·ªãa ch·ªâ nh·∫≠n h√†ng</h4>
                <span class="toggle-arrow" id="arrow">&#9654;</span>
            </div>
            <div id="addressSection" class="toggle-body">
                <input type="text" name="full_name" value="{{ user.full_name }}" placeholder="H·ªç v√† t√™n" required class="checkout-input">
                <input type="text" name="phone_number" value="{{ user.phone_number }}" placeholder="S·ªë ƒëi·ªán tho·∫°i" required class="checkout-input">
                <textarea name="address" placeholder="Nh·∫≠p ƒë·ªãa ch·ªâ nh·∫≠n h√†ng" required class="checkout-textarea">{{ user.address }}</textarea>
            </div>
        </div>

        <!-- S·∫£n ph·∫©m -->
        <div class="checkout-box">
            <h4>üõí S·∫£n ph·∫©m</h4>
            <div class="checkout-product">
                <img src="{{ product.image.url }}" alt="{{ product.name }}">
                <div class="checkout-product-info">
                    <strong>{{ product.name }}</strong><br>
                    SL: 1
                </div>
                <div class="checkout-price">{{ product.price|floatformat:0 }} ƒë</div>
            </div>
        </div>

        <!-- Ph∆∞∆°ng th·ª©c thanh to√°n -->
        <div class="checkout-box">
            <h4>üí≥ Ph∆∞∆°ng th·ª©c thanh to√°n</h4>
            <select name="payment_method" class="checkout-input">
                <option value="COD">Thanh to√°n khi nh·∫≠n h√†ng (COD)</option>
                <option value="Bank">Chuy·ªÉn kho·∫£n ng√¢n h√†ng</option>
                <option value="Wallet">V√≠ ƒëi·ªán t·ª≠ ShopeePay</option>
            </select>
        </div>

        <!-- T·ªïng ti·ªÅn -->
        <div class="checkout-box">
            <h4>T·ªïng thanh to√°n</h4>
            <p class="checkout-total">{{ total_price|floatformat:0 }} ƒë</p>
        </div>

        <!-- N√∫t ƒê·∫∑t H√†ng -->
        <div class="checkout-center">
            <button type="submit" class="checkout-button">ƒê·∫∑t H√†ng</button>
        </div>
    </form>
</div>

<script>
    let isAddressOpen = false;
    function toggleAddress() {
        const section = document.getElementById("addressSection");
        const arrow = document.getElementById("arrow");
        isAddressOpen = !isAddressOpen;

        if (isAddressOpen) {
            section.style.display = "block";
            arrow.classList.add("rotate");
        } else {
            section.style.display = "none";
            arrow.classList.remove("rotate");
        }
    }

    document.querySelector("form").addEventListener("submit", function () {
        document.getElementById("addressSection").style.display = "block";
    });
</script>
